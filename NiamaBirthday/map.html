<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Next Stop: Niama's 30th!</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Montserrat:wght@400;700&family=Roboto+Mono:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; overflow: hidden; }
        body { font-family: 'Montserrat', sans-serif; background-color: #111; position: relative; }
        .font-oswald { font-family: 'Oswald', sans-serif; letter-spacing: 0.1em; }

        /* --- Departure Board Styles --- */
        #departure-board-overlay { position: fixed; inset: 0; z-index: 200; background-color: #000; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: opacity 1.5s ease-out; }
        #board-text { font-family: 'Roboto Mono', monospace; opacity: 0; transition: opacity 0.5s ease-in-out; text-align: center; }
        #departure-board-overlay.show-text #board-text { opacity: 1; }
        .flap { display: inline-block; background-color: #1a1a1a; color: #ffD700; padding: 0.25rem 0.5rem; border-radius: 4px; text-shadow: 0 0 5px #ffD700; }
        @keyframes quick-flip { 0% { transform: scaleY(1); } 50% { transform: scaleY(0); } 100% { transform: scaleY(1); } }
        .flap.flipping { animation: quick-flip 0.1s linear; }
        #departure-board-overlay.unravel { opacity: 0; }

        @keyframes flicker { 0%, 18%, 22%, 25%, 53%, 57%, 100% { text-shadow: 0 0 5px #fff, 0 0 15px #ffD700, 0 0 25px #ffD700; } 20%, 24%, 55% { text-shadow: none; } }
        .flicker-text { animation: flicker 2s infinite alternate; }

        /* --- NEW STYLES for Themed Info Reveal with Background --- */
        #party-info-display {
            width: 90%;
            max-width: 500px;
            /* Added styles for the translucent background */
            background-color: rgba(0, 0, 0, 0.7); /* Dark, 70% opaque */
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); /* Subtle shadow */
            backdrop-filter: blur(5px); /* Frosted glass effect */
            -webkit-backdrop-filter: blur(5px); /* For Safari support */
        }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .info-line { opacity: 0; animation: fade-in-up 1s ease-out forwards; }

        .station-stop {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            text-align: left;
        }
        .line-indicator {
            width: 8px;
            height: 50px;
            margin-right: 1rem;
            flex-shrink: 0;
            border-radius: 4px;
        }
        .stop-text { display: flex; flex-direction: column; }
        .stop-name {
            color: #ccc;
            font-size: 1rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        .stop-detail {
            color: #fff;
            font-size: 1.25rem;
            font-weight: bold;
        }

        /* --- Background Train Animation (Unchanged) --- */
        @keyframes travel { 0% { transform: translateX(-40vw); opacity: 0; } 5% { opacity: 0.6; } 95% { opacity: 0.6; } 100% { transform: translateX(140vw); opacity: 0; } }
        @keyframes travel-reverse { 0% { transform: translateX(140vw); opacity: 0; } 5% { opacity: 0.6; } 95% { opacity: 0.6; } 100% { transform: translateX(-40vw); opacity: 0; } }
        .train-container { position: absolute; top: var(--top-pos); z-index: 5; animation: travel var(--duration) linear infinite; animation-delay: var(--delay); display: flex; gap: 45px; }
        .train-container.reverse { animation-name: travel-reverse; }
        .carriage { width: 100px; height: 30px; position: relative; opacity: 0.9; background-image: linear-gradient(to bottom, #aaa 5px, #0019A8 5px, #0019A8 17px, #aaa 17px); }
        .carriage::before, .carriage::after { content: ''; position: absolute; width: 30px; height: 100%; background-color: var(--train-color); }
        .carriage::before { left: -20px; border-radius: 5px 0 0 5px; }
        .carriage::after { right: -20px; border-radius: 0 5px 5px 0; }
        .train-container.reverse .carriage::before { left: auto; right: -20px; border-radius: 0 5px 5px 0; }
        .train-container.reverse .carriage::after { right: auto; left: -20px; border-radius: 5px 0 0 5px; }
        .carriage.central { --train-color: #DC241F; }
        .carriage.victoria { --train-color: #0098D4; }
        .carriage.district { --train-color: #007A33; }
        .carriage.jubilee { --train-color: #7b9dad; }
        .carriage.metropolitan { --train-color: #970059; }
        .carriage.circle { --train-color: #FFD200; }
    </style>
</head>
<body>

<audio id="background-music" loop autoplay muted>
    <source src="waterloo.mp3" type="audio/mpeg">
</audio>

<button id="mute-button" style="position: fixed; bottom: 15px; right: 15px; z-index: 100; background: #DC241F; color: white; border: none; border-radius: 50%; width: 50px; height: 50px; font-size: 24px; cursor: pointer; display: none;">
    ðŸ”Š
</button>

<div id="departure-board-overlay">
    <div id="board-text" class="text-xl sm:text-3xl md:text-4xl flex flex-col items-center gap-2 sm:gap-4">
        <div class="flex gap-2 sm:gap-4">
            <span class="flap" data-final="C">C</span><span class="flap" data-final="L">L</span><span class="flap" data-final="I">I</span><span class="flap" data-final="C">C</span><span class="flap" data-final="K">K</span><span class="flap" data-final="&nbsp;">&nbsp;</span><span class="flap" data-final="T">T</span><span class="flap" data-final="O">O</span>
        </div>
        <div class="flex gap-2 sm:gap-4">
            <span class="flap" data-final="B">B</span><span class="flap" data-final="O">O</span><span class="flap" data-final="A">A</span><span class="flap" data-final="R">R</span><span class="flap" data-final="D">D</span>
        </div>
    </div>
</div>
<div id="train-depot" class="absolute inset-0 z-0"></div>

<div id="party-info-display" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10">
</div>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        const music = document.getElementById('background-music');
        const muteButton = document.getElementById('mute-button');
        const departureBoardOverlay = document.getElementById('departure-board-overlay');

        const partyStops = [
            { stop: "Passenger", color: "#0019A8", detail: "Niama (The Birthday Girl!)" },
            { stop: "Departure Date", color: "#7b9dad", detail: "Saturday, 1st November 2025" },
            { stop: "Boarding Time", color: "#0098D4", detail: "7:00 PM onwards" },
            { stop: "Final Terminus", color: "#970059", detail: "NW5 2RZ" },
            { stop: "Carriage Attire", color: "#DC241F", detail: "Dress as a Tube Station" },
            { stop: "District Line & Dine", color: "#007A33", detail: "Bring Your Own Booze (BYOB)" },
        ];

        function createTrains() {
            const trainDepot = document.getElementById('train-depot');
            const trainLines = [ { class: 'reverse', color: 'central', top: '10%', duration: '25s', delay: '0s' }, { class: 'reverse', color: 'circle', top: '65%', duration: '18s', delay: '4s' }, { class: 'reverse', color: 'district', top: '50%', duration: '28s', delay: '8s' }, { class: '', color: 'victoria', top: '20%', duration: '24s', delay: '2s' }, { class: '', color: 'jubilee', top: '75%', duration: '19s', delay: '10s' }, { class: '', color: 'metropolitan', top: '35%', duration: '29s', delay: '7s' } ];
            let trainHTML = '';
            trainLines.forEach(line => {
                const numCarriages = Math.floor(Math.random() * 4) + 3;
                let carriagesHTML = '';
                for (let i = 0; i < numCarriages; i++) { carriagesHTML += `<div class="carriage ${line.color}"></div>`; }
                trainHTML += `<div class="train-container ${line.class}" style="--top-pos: ${line.top}; --duration: ${line.duration}; --delay: ${line.delay};">${carriagesHTML}</div>`;
            });
            trainDepot.innerHTML = trainHTML;
        }

        function animateBoard() {
            const flaps = document.querySelectorAll('.flap');
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890';
            let totalDelay = 0;
            departureBoardOverlay.classList.add('show-text');
            flaps.forEach((flap) => {
                const finalChar = flap.getAttribute('data-final');
                if (finalChar === '&nbsp;') { flap.innerHTML = '&nbsp;'; return; }
                setTimeout(() => {
                    let flipCount = 0;
                    const maxFlips = 10 + Math.floor(Math.random() * 10);
                    const flipInterval = setInterval(() => {
                        flap.textContent = chars[Math.floor(Math.random() * chars.length)];
                        flap.classList.add('flipping');
                        setTimeout(() => flap.classList.remove('flipping'), 50);
                        flipCount++;
                        if (flipCount >= maxFlips) { clearInterval(flipInterval); flap.innerHTML = finalChar; }
                    }, 100);
                }, totalDelay);
                totalDelay += 50;
            });
        }

        function revealPartyInfo() {
            const display = document.getElementById('party-info-display');

            setTimeout(() => {
                const title = document.createElement('h1');
                title.textContent = "THE BIRTHDAY EXPRESS";
                title.className = "info-line font-oswald text-4xl sm:text-5xl text-[#FFD200] flicker-text mb-8 text-center";
                display.appendChild(title);
            }, 1500);

            partyStops.forEach((stop, index) => {
                setTimeout(() => {
                    const stopElement = document.createElement('div');
                    stopElement.className = 'info-line station-stop';

                    stopElement.innerHTML = `
                        <div class="line-indicator" style="background-color: ${stop.color};"></div>
                        <div class="stop-text">
                            <p class="stop-name font-oswald">${stop.stop}</p>
                            <p class="stop-detail">${stop.detail}</p>
                        </div>
                    `;
                    display.appendChild(stopElement);
                }, 3500 + (index * 3000));
            });
        }

        createTrains();
        animateBoard();

        departureBoardOverlay.addEventListener('click', () => {
            departureBoardOverlay.classList.add('unravel');
            if (music.paused) { music.play(); }
            if (music.muted) { music.muted = false; fadeInAudio(music); }
            muteButton.style.display = 'block';
            setTimeout(() => { departureBoardOverlay.style.display = 'none'; }, 1500);

            revealPartyInfo();

        }, { once: true });

        muteButton.addEventListener('click', (event) => {
            event.stopPropagation();
            toggleMute();
        });
    });

    function fadeInAudio(audioElement) { let currentVolume = 0; audioElement.volume = currentVolume; const fadeDuration = 10000; const fadeInterval = 100; const volumeIncrement = fadeInterval / fadeDuration; const fadeEffect = setInterval(() => { currentVolume += volumeIncrement; if (currentVolume >= 1) { currentVolume = 1; clearInterval(fadeEffect); } audioElement.volume = currentVolume; }, fadeInterval); }
    function toggleMute() { const music = document.getElementById('background-music'); const muteButton = document.getElementById('mute-button'); music.muted = !music.muted; muteButton.textContent = music.muted ? 'ðŸ”‡' : 'ðŸ”Š'; }
</script>

</body>
</html>
